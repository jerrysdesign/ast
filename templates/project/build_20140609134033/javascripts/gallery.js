$(function(){$.fn.imagesLoaded=function(e){function i(){e.call(a,t)}function n(){0>=--r&&this.src!==l&&(setTimeout(i),t.off("load error",n))}var t=this.find("img"),r=t.length,a=this,l="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";return r||i(),t.on("load error",n).each(function(){if(this.complete||void 0===this.complete){var e=this.src;this.src=l,this.src=e}}),this};var e=$("#rg-gallery"),i=$("#rg-galleryShow"),n=e.find("div.es-carousel-wrapper"),t=n.find("ul > li"),r=t.length;Gallery=function(){var a=0,l="carousel",o=!1,d=function(){t.add('<img src="images/ajax-loader.gif"/><img src="images/black.png"/>').imagesLoaded(function(){c(),g(t.eq(a))}),"carousel"===l&&s()},s=function(){n.show().elastislide({imageW:107,onClick:function(e){return o?!1:(o=!0,g(e),a=e.index(),void 0)}}),n.elastislide("setCurrent",a)},c=function(){if($("#img-wrapper-tmpl").tmpl({itemsCount:r}).appendTo(i),r>1){var n=e.find("a.rg-image-nav-prev"),t=e.find("a.rg-image-nav-next"),a=e.find("div.rg-image");n.on("click.rgGallery",function(){return f("left"),!1}),t.on("click.rgGallery",function(){return f("right"),!1}),a.touchwipe({wipeLeft:function(){f("right")},wipeRight:function(){f("left")},preventDefaultEvents:!1}),$(document).on("keyup.rgGallery",function(e){39==e.keyCode?f("right"):37==e.keyCode&&f("left")})}},f=function(e){return o?!1:(o=!0,"right"===e?a+1>=r?a=0:++a:"left"===e&&(0>a-1?a=r-1:--a),g(t.eq(a)),void 0)},g=function(i){var r=e.find("div.rg-loading").show();t.removeClass("selected"),i.addClass("selected");var d=i.find("img"),s=d.data("large");$("<img/>").load(function(){e.find("div.rg-image").empty().append('<img src="'+s+'"/>'),r.hide(),"carousel"===l&&(n.elastislide("reload"),n.elastislide("setCurrent",a)),o=!1}).attr("src",s)},u=function(e){n.find("ul").append(e),t=t.add($(e)),r=t.length,n.elastislide("add",e)};return{init:d,addItems:u}}(),Gallery.init()});